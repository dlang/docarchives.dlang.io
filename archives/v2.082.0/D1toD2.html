
<!DOCTYPE html>
<html lang="en-US">
<!--
    Copyright (c) 1999-2022 by the D Language Foundation
    All Rights Reserved.
    https://dlang.org/foundation_overview.html
  -->
<head>
<meta charset="utf-8">
<meta name="keywords" content="D programming language">
<meta name="description" content="D Programming Language">
<title>Migrating D1 Code to D2 - D Programming Language</title>

<link rel="stylesheet" href="css/codemirror.css">
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/print.css" media="print">
<link rel="shortcut icon" href="favicon.ico">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.1, maximum-scale=10.0">

</head>
<body id='Migrating D1 Code to D2' class='doc'>
<script type="text/javascript">document.body.className += ' have-javascript'</script>
<div id="top"><div class="helper"><div class="helper expand-container">    <div class="logo"><a href="."><img id="logo" alt="D Logo" src="images/dlogo.svg"></a></div>
    <a href="menu.html" title="Menu" class="hamburger expand-toggle"><span>Menu</span></a>
    
<div id="cssmenu"><ul>    <li><a href='https://tour.dlang.org'><span>Learn</span></a></li>
    <li class='expand-container'><a class='expand-toggle' href='documentation.html'><span>Documentation</span></a>
      
<ul class='expand-content'>    <li><a href='spec/spec.html'>Language Reference</a></li>
    <li><a href='phobos/index.html'>Library Reference</a></li>
    <li><a href='dmd.html'>Command-line Reference</a></li>
    <li class="menu-divider"><a href='comparison.html'>Feature Overview</a></li>
    <li><a href='articles.html'>Articles</a></li>
 </ul></li>
    <li><a href='download.html'><span>Downloads</span></a></li>
    <li><a href='https://code.dlang.org'><span>Packages</span></a></li>
    <li class='expand-container'><a class='expand-toggle' href='community.html'><span>Community</span></a>
      
<ul class='expand-content'>    <li><a href='https://dlang.org/blog'>Blog</a></li>
    <li><a href='orgs-using-d.html'>Orgs using D</a></li>
    <li><a href='https://twitter.com/search?q=%23dlang'>Twitter</a></li>
    <li><a href='calendar.html'>Calendar</a></li>
    <li class="menu-divider"><a href='https://forum.dlang.org'>Forums</a></li>
    <li><a href='irc://irc.freenode.net/d'>IRC</a></li>
    <li><a href='https://wiki.dlang.org'>Wiki</a></li>
    <li class="menu-divider"><a href='https://github.com/dlang'>GitHub</a></li>
    <li><a href='bugstats.html'>Issues</a></li>
    <li><a href='https://wiki.dlang.org/Get_involved'>Get involved</a></li>
    <li class="menu-divider"><a href='foundation/contributors.html'>Contributors</a></li>
    <li><a href='foundation/index.html'>Foundation</a></li>
    <li><a href='/security.html'>Security Team</a></li>
    <li><a href='foundation/donate.html'>Donate</a></li>
    <li><a href='foundation/sponsors.html'>Sponsors</a></li>
 </ul></li>
    <li class='expand-container'><a class='expand-toggle' href='resources.html'><span>Resources</span></a>
      
<ul class='expand-content'>    <li><a href='https://tour.dlang.org'>Tour</a></li>
    <li><a href='https://wiki.dlang.org/Books'>Books</a></li>
    <li><a href='https://wiki.dlang.org/Tutorials'>Tutorials</a></li>
    <li class="menu-divider"><a href='https://wiki.dlang.org/Development_tools'>Tools</a></li>
    <li><a href='https://wiki.dlang.org/Editors'>Editors</a></li>
    <li><a href='https://wiki.dlang.org/IDEs'>IDEs</a></li>
    <li><a href='https://run.dlang.io'>run.dlang.io</a></li>
    <li><a href='http://rainers.github.io/visuald/visuald/StartPage.html'>Visual D</a></li>
    <li class="menu-divider"><a href='acknowledgements.html'>Acknowledgments</a></li>
    <li><a href='dstyle.html'>D Style</a></li>
    <li><a href='glossary.html'>Glossary</a></li>
    <li><a href='sitemap.html'>Sitemap</a></li>
 </ul></li>
</ul></div>
    <div class="search-container expand-container">        <a href="search.html" class="expand-toggle" title="Search"><span>Search</span></a>
        
    <div id="search-box">        <form method="get" action="https://google.com/search">
            <input type="hidden" id="domains" name="domains" value="dlang.org">
            <input type="hidden" id="sourceid" name="sourceid" value="google-search">
            <span id="search-query"><input id="q" name="q" placeholder="Search"></span><span id="search-dropdown"><span class="helper">                <select id="sitesearch" name="sitesearch" size="1">
                    <option value="dlang.org">Entire Site</option>
                    <option  value="dlang.org/spec">Language</option>
                    <option  value="dlang.org/phobos">Library</option>
                    <option  value="forum.dlang.org">Forums</option>
                    
                </select>
            </span></span><span id="search-submit"><button type="submit"><i class="fa fa-search"></i><span>go</span></button></span>
        </form>
    </div>
    </div>
</div></div></div>

<div class="container">    
    <div class="hyphenate" id="content">        
<div id="tools"><div >	<div class="tip smallprint">		<a href="https://issues.dlang.org/enter_bug.cgi?bug_file_loc=http%3A%2F%2Fdlang.org/&amp;component=dlang.org&amp;op_sys=All&amp;priority=P3&amp;product=D&amp;rep_platform=All&amp;short_desc=%5BMigrating D1 Code to D2%5D&amp;version=D2&amp;bug_severity=enhancement">Report a bug</a>
		<div >			If you spot a problem with this page, click here to create a Bugzilla issue.
		</div>
	</div>
	<div class="tip smallprint">		<a href="https://github.com/dlang/dlang.org/edit/master/D1toD2.dd">Improve this page</a>
		<div >			Quickly fork, edit online, and submit a pull request for this page.
			Requires a signed-in GitHub account. This works well for small changes.
			If you'd like to make larger changes you may want to consider using
			a local clone.
		</div>
	</div>
</div></div>
        <h1>Migrating D1 Code to D2</h1>
        
        


        <p>There are many changes to the D programming language that affect
        migrating source code from D1 to D2.
        This is an outline of changes to look for and a guide to how to modify
        the code.
        </p>

        <p>This document is incomplete.</p>

<ul>    <li>Core Language
    <ul>        <li><a href="#new_keywords">New Keywords</a></li>
        <li><a href="#global_variables">Global Variables</a></li>
        <li><a href="#static_arrays">Static Arrays are now Value Types</a></li>
        <li><a href="#immutable_string">String Literals are Immutable</a></li>
    </ul>
    </li>

    <li>Phobos Library
    <ul>    </ul>
    </li>
</ul>

<hr><h3><span class="def-anchor" id="new_keywords"></span>New Keywords</h3>

        <p>D2 adds the following keywords:
        <span class="d_keyword">pure</span>,
        <span class="d_keyword">nothrow</span>,
        <span class="d_keyword">shared</span>, and
        <span class="d_keyword">immutable</span>.
        Any use of them in D1 code must be renamed.
        Any variable names starting with two underscores
        should be renamed.
        </p>

<hr><h3><span class="def-anchor" id="global_variables"></span>Global Variables</h3>

        <p>Global variables are now, by default, stored in thread local
        storage. To put them back in global storage, use the <span class="d_keyword">__gshared</span>
        storage class:</p>

<pre class="d_code notranslate"><span class="d_keyword">int</span> foo = 7; <span class="d_comment">// D1 code
</span><b><span class="d_keyword">__gshared</span></b> <span class="d_keyword">int</span> foo = 7; <span class="d_comment">// D2 equivalent
</span></pre>

        <p>Carefully consider whether or not those variables actually should
        go into thread local storage, rather than being implicitly shared
        among all threads.
        </p>

<hr><h3><span class="def-anchor" id="static_arrays"></span>Static Arrays are now Value Types</h3>

        <p>In D1, a static array function parameter is passed by
        reference, meaning a pointer to the start of the static array
        is passed as an argument.
        This means that any changes to the array contents made by the
        function will be visible to the function's caller.
        In D2, a copy of the whole static
        array is passed as an argument. Changes to the array contents by
        the function are not visible to the function's caller, as it is
        a separate copy.</p>

        <p>To migrate, add the keyword <span class="d_keyword">ref</span> to the parameter
        declaration:</p>

<pre class="d_code notranslate"><span class="d_keyword">void</span> foo(<span class="d_keyword">int</span>[3] array);      <span class="d_comment">// D1 code
</span><span class="d_keyword">void</span> foo(<b><span class="d_keyword">ref</span></b> <span class="d_keyword">int</span>[3] array);  <span class="d_comment">// D2 equivalent
</span></pre>

<hr><h3><span class="def-anchor" id="immutable_string"></span>String Literals are Immutable</h3>

        <p>String literals in D1 have type <span class="d_inlinecode donthyphenate notranslate">char[]</span>, but in D2 they
        have type <span class="d_inlinecode donthyphenate notranslate">immutable(char)[]</span>, which is aliased for convenience
        under the name <span class="d_inlinecode donthyphenate notranslate">string</span>.  To migrate usually involves doing a
        global search replace: </p>

        <table>        <tr><th scope="col">from</th><th scope="col">to</th></tr>
        <tr><td>char[]</td><td>string</td></tr>
        <tr><td>wchar[]</td><td>wstring</td></tr>
        <tr><td>dchar[]</td><td>dstring</td></tr>
        </table>

        <p>This will take care of most of the issues.
        For the rest, where mutable strings are desired, there will
        be some work necessary.
        </p>




        <div class="smallprint" id="copyright">Copyright &copy; 1999-2022 by the <a href="foundation_overview.html">D Language Foundation</a> | Page generated by
<a href="spec/ddoc.html">Ddoc</a> on (no date time)</div>
    </div>
</div>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript">window.jQuery || document.write('\x3Cscript src="js/jquery-1.7.2.min.js">\x3C/script>');</script>
    <script type="text/javascript" src="js/dlang.js"></script>
    
    <script type="text/javascript" src="js/codemirror-compressed.js"></script>
    <script type="text/javascript" src="js/run.js"></script>


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
</body>
</html>
