
<!DOCTYPE html>
<html lang="en-US">
<!--
    Copyright (c) 1999-2024 by the D Language Foundation
    All Rights Reserved.
    https://dlang.org/foundation_overview.html
  -->
<head>
<meta charset="utf-8">
<meta name="keywords" content="D programming language">
<meta name="description" content="D Programming Language">
<title>Pragmas - D Programming Language</title>

<link rel="stylesheet" href="../css/codemirror.css">
<link rel="stylesheet" href="../css/style.css">
<link rel="stylesheet" href="../css/print.css" media="print">
<link rel="shortcut icon" href="../favicon.ico">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.1, maximum-scale=10.0">

</head>
<body id='Pragmas' class='doc'>
<script type="text/javascript">document.body.className += ' have-javascript'</script>
<div id="top"><div class="helper"><div class="helper expand-container">    <div class="logo"><a href="."><img id="logo" alt="D Logo" src="../images/dlogo.svg"></a></div>
    <a href="../menu.html" title="Menu" class="hamburger expand-toggle"><span>Menu</span></a>
    
<div id="cssmenu"><ul>    <li><a href='https://tour.dlang.org'><span>Learn</span></a></li>
    <li class='expand-container'><a class='expand-toggle' href='../documentation.html'><span>Documentation</span></a>
      
<ul class='expand-content'>    <li><a href='../spec/spec.html'>Language Reference</a></li>
    <li><a href='../phobos/index.html'>Library Reference</a></li>
    <li><a href='../dmd.html'>Command-line Reference</a></li>
    <li class="menu-divider"><a href='../comparison.html'>Feature Overview</a></li>
    <li><a href='../articles.html'>Articles</a></li>
 </ul></li>
    <li><a href='../download.html'><span>Downloads</span></a></li>
    <li><a href='https://code.dlang.org'><span>Packages</span></a></li>
    <li class='expand-container'><a class='expand-toggle' href='../community.html'><span>Community</span></a>
      
<ul class='expand-content'>    <li><a href='https://dlang.org/blog'>Blog</a></li>
    <li><a href='../orgs-using-d.html'>Orgs using D</a></li>
    <li><a href='https://twitter.com/search?q=%23dlang'>Twitter</a></li>
    <li><a href='../calendar.html'>Calendar</a></li>
    <li class="menu-divider"><a href='https://forum.dlang.org'>Forums</a></li>
    <li><a href='irc://irc.libera.chat/d'>IRC</a></li>
    <li><a href='https://discord.gg/bMZk9Q4'>Community Discord</a></li>
    <li><a href='https://wiki.dlang.org'>Wiki</a></li>
    <li class="menu-divider"><a href='https://github.com/dlang'>GitHub</a></li>
    <li><a href='../bugstats.html'>Issues</a></li>
    <li><a href='https://wiki.dlang.org/Get_involved'>Get involved</a></li>
    <li class="menu-divider"><a href='../foundation/contributors.html'>Contributors</a></li>
    <li><a href='../foundation/index.html'>Foundation</a></li>
    <li><a href='..//security.html'>Security Team</a></li>
    <li><a href='../foundation/donate.html'>Donate</a></li>
    <li><a href='../foundation/sponsors.html'>Sponsors</a></li>
 </ul></li>
    <li class='expand-container'><a class='expand-toggle' href='../resources.html'><span>Resources</span></a>
      
<ul class='expand-content'>    <li><a href='https://tour.dlang.org'>Tour</a></li>
    <li><a href='https://wiki.dlang.org/Books'>Books</a></li>
    <li><a href='https://wiki.dlang.org/Tutorials'>Tutorials</a></li>
    <li class="menu-divider"><a href='https://wiki.dlang.org/Development_tools'>Tools</a></li>
    <li><a href='https://wiki.dlang.org/Editors'>Editors</a></li>
    <li><a href='https://wiki.dlang.org/IDEs'>IDEs</a></li>
    <li><a href='https://run.dlang.io'>run.dlang.io</a></li>
    <li><a href='http://rainers.github.io/visuald/visuald/StartPage.html'>Visual D</a></li>
    <li class="menu-divider"><a href='../acknowledgements.html'>Acknowledgments</a></li>
    <li><a href='../dstyle.html'>D Style</a></li>
    <li><a href='../glossary.html'>Glossary</a></li>
    <li><a href='../sitemap.html'>Sitemap</a></li>
 </ul></li>
</ul></div>
    <div class="search-container expand-container">        <a href="../search.html" class="expand-toggle" title="Search"><span>Search</span></a>
        
    <div id="search-box">        <form method="get" action="https://google.com/search">
            <input type="hidden" id="domains" name="domains" value="dlang.org">
            <input type="hidden" id="sourceid" name="sourceid" value="google-search">
            <span id="search-query"><input id="q" name="q" placeholder="Search"></span><span id="search-dropdown"><span class="helper">                <select id="sitesearch" name="sitesearch" size="1">
                    <option value="dlang.org">Entire Site</option>
                    <option  value="dlang.org/spec">Language</option>
                    <option  value="dlang.org/phobos">Library</option>
                    <option  value="forum.dlang.org">Forums</option>
                    
                </select>
            </span></span><span id="search-submit"><button type="submit"><i class="fa fa-search"></i><span>go</span></button></span>
        </form>
    </div>
    </div>
</div></div></div>

<div class="container">    
    <div class="hyphenate" id="content">        
<div id="tools"><div >	<div class="tip smallprint">		<a href="https://issues.dlang.org/enter_bug.cgi?bug_file_loc=http%3A%2F%2Fdlang.org/&amp;component=dlang.org&amp;op_sys=All&amp;priority=P3&amp;product=D&amp;rep_platform=All&amp;short_desc=%5BPragmas%5D&amp;version=D2&amp;bug_severity=enhancement">Report a bug</a>
		<div >			If you spot a problem with this page, click here to create a Bugzilla issue.
		</div>
	</div>
	<div class="tip smallprint">		<a href="https://github.com/dlang/dlang.org/edit/master/d.en/pragma.d">Improve this page</a>
		<div >			Quickly fork, edit online, and submit a pull request for this page.
			Requires a signed-in GitHub account. This works well for small changes.
			If you'd like to make larger changes you may want to consider using
			a local clone.
		</div>
	</div>
</div></div>
        <h1>Pragmas</h1>
        
        



<p>Pragmas are a way of interacting with the compiler. They can be for providing special information to the compiler as well as getting information from it. Although they are useful in non-templated code as well, <code class="d_inline">pragma(msg)</code> can be helpful when debugging templates.
</p>

<p>Every compiler vendor is free to introduce their special <code class="d_inline">pragma</code> directives in addition to the following mandatory ones:
</p>

<h5 class="subsection"><code class="d_inline">pragma(msg)</code></h5>

<p>Prints a message to <code class="d_inline">stderr</code> during compilation. No message is printed during the execution of the compiled program.
</p>

<p>For example, the following <code class="d_inline">pragma(msg)</code> is being used for exposing the types of template parameters, presumably during debugging:
</p>

<pre class="d_code"><span class="d_keyword">import</span> std.string;

<span class="d_keyword">void</span> func(A, B)(A a, B b) {
    <span class="d_keyword">pragma</span>(<span class="hilite">msg</span>, format(<span class="d_string">"Called with types '%s' and '%s'"</span>,
                       A.stringof, B.stringof));
    <span class="d_comment">// ...
</span>}

<span class="d_keyword">void</span> main() {
    func(42, 1.5);
    func(<span class="d_string">"hello"</span>, 'a');
}
</pre>

<pre class="shell">Called with types 'int' and 'double'
Called with types 'string' and 'char'
</pre>

<h5 class="subsection"><code class="d_inline">pragma(lib)</code></h5>

<p>Instructs the compiler to link the program with a particular library. This is the easiest way of linking the program with a library that is already installed on the system.
</p>

<p>For example, the following program would be linked with the <code class="d_inline">curl</code> library without needing to mention the library on the command line:
</p>

<pre class="d_code"><span class="d_keyword">import</span> std.stdio;
<span class="d_keyword">import</span> std.net.curl;

<span class="d_keyword">pragma</span>(<span class="hilite">lib</span>, <span class="d_string">"curl"</span>);

<span class="d_keyword">void</span> main() {
    <span class="d_comment">// Get this chapter
</span>    writeln(get(<span class="d_string">"ddili.org/pragma.html"</span>));
}
</pre>

<h5 class="subsection"><a id="ix_Pragmas.inline" content="inline"></a> <a id="ix_Pragmas.function inlining" content="function inlining"></a> <a id="ix_Pragmas.optimization, compiler" content="optimization, compiler"></a> <code class="d_inline">pragma(inline)</code></h5>

<p>Specifies whether a function should be <i>inlined</i> or not.
</p>

<p>Every function call has some performance cost. Function calls involve passing arguments to the function, returning its return value to the caller, and handling some bookkeeping information to remember where the function was called from so that the execution can continue after the function returns.
</p>

<p>This cost is usually insignificant compared to the cost of actual work that the caller and the callee perform. However, in some cases just the act of calling a certain function can have a measurable effect on the program's performance. This can happen especially when the function body is relatively fast and when it is called from a short loop that repeats many times.
</p>

<p>The following program calls a small function from a loop and increments a counter when the returned value satisfies a condition:
</p>

<pre class="d_code"><span class="d_keyword">import</span> std.stdio;
<span class="d_keyword">import</span> std.datetime.stopwatch;

<span class="d_comment">// A function with a fast body:
</span><span class="d_keyword">ubyte</span> compute(<span class="d_keyword">ubyte</span> i) {
    <span class="d_keyword">return</span> <span class="d_keyword">cast</span>(<span class="d_keyword">ubyte</span>)(i * 42);
}

<span class="d_keyword">void</span> main() {
    size_t counter = 0;

    StopWatch sw;
    sw.start();

    <span class="d_comment">// A short loop that repeats many times:
</span>    <span class="d_keyword">foreach</span> (i; 0 .. 100_000_000) {
        <span class="d_keyword">const</span> number = <span class="d_keyword">cast</span>(<span class="d_keyword">ubyte</span>)i;

        <span class="d_keyword">if</span> (<span class="hilite">compute(number)</span> == number) {
            ++counter;
        }
    }

    sw.stop();

    writefln(<span class="d_string">"%s milliseconds"</span>, sw.peek.total!<span class="d_string">"msecs"</span>);
}
</pre>

<p><a id="ix_Pragmas.StopWatch, std.datetime.stopwatch" content="StopWatch, std.datetime.stopwatch"></a> The code takes advantage of <code class="d_inline">std.datetime.stopwatch.StopWatch</code> to measure the time it takes executing the entire loop:
</p>

<pre class="shell"><span class="hilite">674</span> milliseconds
</pre>

<p><a id="ix_Pragmas.-inline, compiler switch" content="-inline, compiler switch"></a> The <code class="d_inline">-inline</code> compiler switch instructs the compiler to perform a compiler optimization called <i>function inlining</i>:
</p>

<pre class="shell">$ dmd deneme.d -w <span class="hilite">-inline</span>
</pre>

<p>When a function is inlined, its body is injected into code right where it is called from; no actual function call happens. The following is the equivalent code that the compiler would compile after inlining:
</p>

<pre class="d_code">    <span class="d_comment">// An equivalent of the loop when compute() is inlined:
</span>    <span class="d_keyword">foreach</span> (i; 0 .. 100_000_000) {
        <span class="d_keyword">const</span> number = <span class="d_keyword">cast</span>(<span class="d_keyword">ubyte</span>)i;

        <span class="d_keyword">const</span> result = <span class="hilite"><span class="d_keyword">cast</span>(<span class="d_keyword">ubyte</span>)(number * 42)</span>;
        <span class="d_keyword">if</span> (result == number) {
            ++counter;
        }
    }
</pre>

<p>On the platform that I tested that program, eliminating the function call reduced the execution time by about 40%:
</p>

<pre class="shell"><span class="hilite">407</span> milliseconds
</pre>

<p>Although function inlining looks like a big gain, it cannot be applied for every function call because otherwise inlined bodies of functions would make code too large to fit in the CPU's <i>instruction cache</i>. Unfortunately, this can make the code even slower. For that reason, the decision of which function calls to inline is usually left to the compiler.
</p>

<p>However, there may be cases where it is beneficial to help the compiler with this decision. The <code class="d_inline">inline</code> pragma instructs the compiler in its inlining decisions:
</p>

<ul>
<li><code class="d_inline">pragma(inline, false)</code>: Instructs the compiler to never inline certain functions even when the <code class="d_inline">-inline</code> compiler switch is specified.</li>

<li><code class="d_inline">pragma(inline, true)</code>: Instructs the compiler to definitely inline certain functions when the <code class="d_inline">-inline</code> compiler switch is specified. This causes a compilation error if the compiler cannot inline such a function. (The exact behavior of this pragma may be different on your compiler.)</li>

<li><code class="d_inline">pragma(inline)</code>: Sets the inlining behavior back to the setting on the compiler command line: whether <code class="d_inline">-inline</code> is specified or not.</li>

</ul>

<p>These pragmas can affect the function that they appear in, as well as they can be used with a scope or colon to affect more than one function:
</p>

<pre class="d_code"><span class="d_keyword">pragma</span>(inline, <span class="d_keyword">false</span>) <span class="hilite">{</span>
    <span class="d_comment">// Functions defined in this scope should not be inlined
</span>    <span class="d_comment">// ...
</span><span class="hilite">}</span>

<span class="d_keyword">int</span> foo() {
    <span class="d_keyword">pragma</span>(inline, <span class="d_keyword">true</span>);  <span class="d_comment">// This function should be inlined
</span>    <span class="d_comment">// ...
</span>}

<span class="d_keyword">pragma</span>(inline, <span class="d_keyword">true</span>)<span class="hilite">:</span>
<span class="d_comment">// Functions defined in this section should be inlined
</span><span class="d_comment">// ...
</span>
<span class="d_keyword">pragma</span>(inline)<span class="hilite">:</span>
<span class="d_comment">// Functions defined in this section should be inlined or not
</span><span class="d_comment">// depending on the -inline compiler switch
</span><span class="d_comment">// ...
</span></pre>

<p><a id="ix_Pragmas.-O, compiler switch" content="-O, compiler switch"></a> Another compiler switch that can make programs run faster is <code class="d_inline">-O</code>, which instructs the compiler to perform more optimization algorithms. However, faster program speeds come at the expense of slower compilation speeds because these algorithms take significant amounts of time.
</p>

<h5 class="subsection"><a id="ix_Pragmas.startaddress" content="startaddress"></a> <code class="d_inline">pragma(startaddress)</code></h5>

<p>Specifies the start address of the program. Since the start address is normally assigned by the D runtime environment, it is very unlikely that you will ever use this pragma.
</p>

<h5 class="subsection"><a id="ix_Pragmas.mangle, pragma" content="mangle, pragma"></a> <a id="ix_Pragmas.name mangling" content="name mangling"></a> <code class="d_inline">pragma(mangle)</code></h5>

<p>Specifies that a symbol should be <i>name mangled</i> differently from the default name mangling method. Name mangling is about how the linker identifies functions and their callers. This pragma is useful when D code needs to call a library function that happens to be a D keyword.
</p>

<p>For example, if a C library had a function named <code class="d_inline">override</code>, because <code class="d_inline">override</code> happens to be a keyword in D, the only way of calling it from D would be through a different name. However, that different name must still be mangled as the actual function name in the library for the linker to be able to identify it:
</p>

<pre class="d_code"><span class="d_comment">/* If a C library had a function named 'override', it could
 * only be called from D through a name like 'c_override',
 * mangled as the actual function name: */</span>
<span class="d_keyword">pragma</span>(<span class="hilite">mangle</span>, <span class="d_string">"override"</span>)
<span class="d_keyword">extern</span>(C) string c_override(string);

<span class="d_keyword">void</span> main() {
    <span class="d_comment">/* D code calls the function as c_override() but the
     * linker would find it by its correct C library name
     * 'override': */</span>
    <span class="d_keyword">auto</span> s = <span class="hilite">c_override</span>(<span class="d_string">"hello"</span>);
}
</pre>


        <div class="smallprint" id="copyright">Copyright &copy; 1999-2024 by the <a href="../foundation_overview.html">D Language Foundation</a> | Page generated by
<a href="../spec/ddoc.html">Ddoc</a> on Mon Jan 29 20:59:45 2024
</div>
    </div>
</div>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript">window.jQuery || document.write('\x3Cscript src="../js/jquery-1.7.2.min.js">\x3C/script>');</script>
    <script type="text/javascript" src="../js/dlang.js"></script>
    
    <script type="text/javascript" src="../js/codemirror-compressed.js"></script>
    <script type="text/javascript" src="../js/run.js"></script>


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
</body>
</html>
