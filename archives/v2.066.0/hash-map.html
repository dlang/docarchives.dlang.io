
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en-US">

<!--
    Copyright (c) 1999-2017 by Digital Mars
    All Rights Reserved Written by Walter Bright
    http://digitalmars.com
  -->

<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="keywords" content="D programming language" />
<meta name="description" content="D Programming Language" />
<title>Associative Arrays - D Programming Language</title>
<link rel="stylesheet" href="css/codemirror.css" />
<link rel="stylesheet" type="text/css" href="css/style.css" />
<link rel="stylesheet" type="text/css" href="css/print.css" media="print" />
<link rel="shortcut icon" href="favicon.ico" />

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script src="js/codemirror-compressed.js"></script>
<script src="js/run-main-website.js" type="text/javascript"></script>
<script src="js/run.js" type="text/javascript"></script>

<script type="text/javascript">
function bodyLoad()
{
    var links = document.getElementById("navigation").getElementsByTagName("a");
    for (var i = 0; i < links.length; i++)
    {
        var url = "/" + links[i].getAttribute("href");
        if (window.location.href.match(url + "\x24") == url)
        {
            var cls = links[i].getAttribute("class");
            links[i].setAttribute("class", cls ? cls + " active" : "active");
            break;
        }
    }
}
</script>
</head>

<body onLoad='bodyLoad()'>

<div id="top">
    <div id="search-box">
        <form method="get" action="http://google.com/search">
            <img src="images/search-left.gif" width="11" height="22" /><input id="q" name="q" /><input type="image" id="search-submit" name="submit" src="images/search-button.gif" />
            <input type="hidden" id="domains" name="domains" value="dlang.org" />
            <input type="hidden" id="sourceid" name="sourceid" value="google-search" />
            <div id="search-dropdown">
                <select id="sitesearch" name="sitesearch" size="1">
                    <option value="dlang.org">Entire D Site</option>
                    <option value="dlang.org/phobos">Library Reference</option>
                    <option value="digitalmars.com/d/archives">Newsgroup Archives</option>
                </select>
            </div>
        </form>
    </div>
    <div id="header">
        <a id="d-language" href="/">
        <img id="logo" width="125" height="95" border="0" alt="D Logo" src="images/dlogo.png">
        D Programming Language</a>
    </div>
</div>

<!--Generated by Ddoc from hash-map.dd-->



<div id="navigation">
  

<div class="navblock">
<h2><a href="index.html" title="D Programming Language">D 2.066.0</a></h2>
<ul>    <li><a href="overview.html" title="D language overview">Overview</a></li>
    <li><a href="comparison.html" title="D feature list">Features</a></li>
    <li><a href="download.html" title="Download a D compiler">Downloads &amp; Tools</a></li>
    <li><a href="changelog.html" title="History of changes to D">Change Log</a></li>
    <li><a href="bugstats.php" title="D issue and bug tracking system">Bug Tracker</a></li>
    <li><a href="faq.html" title="Frequently Asked Questions">FAQ</a></li>
    <li><a href="appendices.html">Appendices</a></li>
    <li><a href="acknowledgements.html" title="Thank-you to these people who have helped with D">Acknowledgments</a></li>
    <li><a href="sitemap.html" title="Documents on this site, indexed alphabetically">Sitemap</a></li>
    <li><a href="http://digitalmars.com/d/1.0/index.html" title="D Programming Language 1.0">D1 Home</a></li>
</ul>
    </div>

<div class="navblock">
<h2>Documentation</h2>
<ul>    <li><a href="http://ddili.org/ders/d.en/index.html">Online Book (free)</a></li>
    <li><a href="http://wiki.dlang.org/Books" title="D Programming Language Books">More Books</a></li>

    <li><a href="language-reference.html">Language Reference</a>

    <div class="navblock">
<ul>    <li><a href="intro.html">Introduction</a></li>
    <li><a href="lex.html">Lexical</a></li>
    <li><a href="grammar.html">Grammar</a></li>
    <li><a href="module.html">Modules</a></li>
    <li><a href="declaration.html">Declarations</a></li>
    <li><a href="type.html">Types</a></li>
    <li><a href="property.html">Properties</a></li>
    <li><a href="attribute.html">Attributes</a></li>
    <li><a href="pragma.html">Pragmas</a></li>
    <li><a href="expression.html">Expressions</a></li>
    <li><a href="statement.html">Statements</a></li>
    <li><a href="arrays.html">Arrays</a></li>
    <li><a href="hash-map.html">Associative Arrays</a></li>
    <li><a href="struct.html">Structs &amp; Unions</a></li>
    <li><a href="class.html">Classes</a></li>
    <li><a href="interface.html">Interfaces</a></li>
    <li><a href="enum.html">Enums</a></li>
    <li><a href="const3.html">Const and Immutable</a></li>
    <li><a href="function.html">Functions</a></li>
    <li><a href="operatoroverloading.html">Operator Overloading</a></li>
    <li><a href="template.html">Templates</a></li>
    <li><a href="template-mixin.html">Template Mixins</a></li>
    <li><a href="contracts.html">Contracts</a></li>
    <li><a href="version.html">Conditional Compilation</a></li>
    <li><a href="traits.html">Traits</a></li>
    <li><a href="errors.html">Handling errors</a></li>
    <li><a href="unittest.html">Unit Tests</a></li>
    <li><a href="garbage.html">Garbage Collection</a></li>
    <li><a href="float.html">Floating Point</a></li>
    <li><a href="iasm.html">Inline Assembler</a></li>
    <li><a href="ddoc.html">Documentation Comments</a></li>
    <li><a href="interfaceToC.html">Interfacing To C</a></li>
    <li><a href="cpp_interface.html">Interfacing To C++</a></li>
    <li><a href="portability.html">Portability Guide</a></li>
    <li><a href="entity.html">Named Character Entities</a></li>
    <li><a href="memory-safe-d.html">Memory Safe D Spec</a></li>
    <li><a href="abi.html">Application Binary Interface</a></li>
    <li><a href="simd.html">Vector Extensions</a></li>
    </ul>
</div></li>
    <li><a href="phobos/index.html">Library Reference</a></li>
    <li><a href="library/index.html">&nbsp;<font size=-1><span style="visibility: hidden">3</span>Preview new Layout</font></a></li>

    <li><a href="howtos.html" title="Helps for using D">How-tos</a></li>
    <li><a href="articles.html">Articles</a></li>
</ul>
    </div>

<div class="navblock">
<h2><a href="http://rainers.github.io/visuald/visuald/StartPage.html">Visual D</a></h2>
<ul></ul>
    </div>

<div class="navblock">
<h2>Community</h2>
<ul>    <li><a href="http://forum.dlang.org/" title="User forums">Forums</a></li>
    <li><a href="http://github.com/D-Programming-Language" title="D on github">GitHub</a></li>
    <li><a href="http://wiki.dlang.org" title="Wiki for the D Programming Language">Wiki</a></li>
    <li><a href="http://wiki.dlang.org/Review_Queue" title="Queue of current and upcoming standard library additions">Review Queue</a></li>
    <li><a href="http://code.dlang.org" title="Third party packages written in D">Third Party Packages</a></li>
    <li><a href="http://twitter.com/#search?q=%23d_lang" title="#d_lang on twitter.com">Twitter</a></li>
    <li><a href="http://digitalmars.com/d/dlinks.html" title="External D related links">Links</a></li>
    
</ul>
    </div>
  
<div id="translate" class="tool">Translate this page:
    <div id="google_translate_element"></div><script type="text/javascript">
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({
        pageLanguage: 'en',
        autoDisplay: false,
        layout: google.translate.TranslateElement.InlineLayout.SIMPLE
      }, 'google_translate_element');
    }
    </script>
<script type="text/javascript" src="http://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</div>
</div><!--/navigation-->
<div id="content" class='hyphenate'>
  
<div id="tools">
    <!--span id="lastupdate">Last update (no date time)</span-->
    <span class="tip">
        <a href="https://github.com/D-Programming-Language/dlang.org/edit/master/hash-map.dd" class="button">Improve this page</a>
        <span>
            Quickly fork, edit online, and submit a pull request for this page.
            Requires a signed-in GitHub account. This works well for small changes.
            If you'd like to make larger changes you may want to consider using
            local clone.
        </span>
    </span>
    <span class="tip">
        <a href="http://wiki.dlang.org/DocComments/AssociativeArrays" class="button">Page wiki</a>
        <span>
            View or edit the community-maintained wiki page associated with this page.
        </span>
    </span>
</div>
  <h1>Associative Arrays</h1>
  
        <p>Associative arrays have an index that is not necessarily an integer,
        and can be sparsely populated. The index for an associative array
        is called the <i>key</i>, and its type is called the <i>KeyType</i>.</p>

        <p>Associative arrays are declared by placing the <i>KeyType</i>
        within the [ ] of an array declaration:
        </p>

<pre class="d_code"><span class="notranslate"><span class="d_keyword">int</span>[string] b;    <span class="d_comment">// associative array b of ints that are
</span>                  <span class="d_comment">// indexed by an array of characters.
</span>                  <span class="d_comment">// The KeyType is string
</span>b[<span class="d_string">"hello"</span>] = 3;   <span class="d_comment">// set value associated with key "hello" to 3
</span>func(b[<span class="d_string">"hello"</span>]); <span class="d_comment">// pass 3 as parameter to func()
</span></span></pre>

        <p><font color=blue><b>Note:</b></font> The built-in associative arrays do not preserve the order
        of the keys inserted into the array. In particular, in a <span class="notranslate"><span class="d_inlinecode donthyphenate">foreach</span></span> loop the 
        order in which the elements are iterated is unspecified.</p>

        <p>Particular keys in an associative array can be removed with the
        remove function:
        </p>

<pre class="d_code"><span class="notranslate">b.<b><i>remove</i></b>(<span class="d_string">"hello"</span>);
</span></pre>

        <p>remove(key) does nothing if the given <i>key</i> does not exist and
        returns <span class="notranslate"><span class="d_inlinecode donthyphenate">false</span></span>.  If the given <i>key</i> does exist, it removes it
        from the AA and returns <span class="notranslate"><span class="d_inlinecode donthyphenate">true</span></span>.
        </p>

        <p>The <i>InExpression</i> yields a pointer to the value
        if the key is in the associative array, or <span class="notranslate"><span class="d_inlinecode donthyphenate">null</span></span> if not:
        </p>

<pre class="d_code"><span class="notranslate"><span class="d_keyword">int</span>* p;
p = (<span class="d_string">"hello"</span> <b><i><span class="d_keyword">in</span></i></b> b);
<span class="d_keyword">if</span> (p !<span class="d_keyword">is</span> <span class="notranslate"><span class="d_inlinecode donthyphenate"><span class="d_keyword">null</span></span></span>)
        ...
</span></pre>

        <p>Neither the <i>KeyType</i>s nor the element types of an associative 
        array can be functions or voids.
        </p>

<h3>Using Classes as the KeyType</h3>

        <p>Classes can be used as the <i>KeyType</i>. For this to work,
        the class definition must override the following member functions
        of class <span class="notranslate"><span class="d_inlinecode donthyphenate">Object</span></span>:</p>

        <ul>        <li><span class="notranslate"><span class="d_inlinecode donthyphenate">hash_t toHash()</span></span></li>
        <li><span class="notranslate"><span class="d_inlinecode donthyphenate">bool opEquals(Object)</span></span></li>
        </ul>

        <p><span class="notranslate"><span class="d_inlinecode donthyphenate">hash_t</span></span> is an alias to an integral type.</p>

        <p>Note that the parameter to <span class="notranslate"><span class="d_inlinecode donthyphenate">opEquals</span></span> is
        of type
        <span class="notranslate"><span class="d_inlinecode donthyphenate">Object</span></span>, not the type of the class in which it is defined.</p>

        <p>For example:</p>

<pre class="d_code"><span class="notranslate"><span class="d_keyword">class</span> Foo {
  <span class="d_keyword">int</span> a, b;

  hash_t <b><i>toHash</i></b>() { <span class="d_keyword">return</span> a + b; }

  <span class="d_keyword">bool</span> <b><i>opEquals</i></b>(Object o)
  { Foo foo = <span class="d_keyword">cast</span>(Foo) o;
    <span class="d_keyword">return</span> foo &amp;&amp; a == foo.a &amp;&amp; b == foo.b;
  }
}
</span></pre>

        <p>Care should be taken that <span class="notranslate"><span class="d_inlinecode donthyphenate">toHash</span></span> should consistently be the
        same value when <span class="notranslate"><span class="d_inlinecode donthyphenate">opEquals</span></span> returns true. In other words, two objects
        that are considered equal should always have the same hash value. If
        this is not the case, the associative array will not function properly.
        Also note that <span class="notranslate"><span class="d_inlinecode donthyphenate">opCmp</span></span> is not used to check for equality by the
        associative array. However, since the actual <span class="notranslate"><span class="d_inlinecode donthyphenate">opEquals</span></span> or <span class="notranslate"><span class="d_inlinecode donthyphenate">        opCmp</span></span> called is not decided until runtime, the compiler cannot always
        detect mismatched functions. Because of legacy issues, the compiler may
        reject an associative array key type that overrides <span class="notranslate"><span class="d_inlinecode donthyphenate">opCmp</span></span> but not
        <span class="notranslate"><span class="d_inlinecode donthyphenate">opEquals</span></span>. This restriction may be removed in future versions of
        D.</p>

<h3>Using Structs or Unions as the KeyType</h3>

        <p>If the <i>KeyType</i> is a struct or union type,
        a default mechanism is used
        to compute the hash and comparisons of it based on the binary
        data within the struct value. A custom mechanism can be used
        by providing the following functions as struct members:
        </p>

<pre class="d_code"><span class="notranslate"><span class="d_keyword">const</span> hash_t <b><i>toHash</i></b>();
<span class="d_keyword">const</span> <span class="d_keyword">bool</span> <b><i>opEquals</i></b>(<span class="d_keyword">ref</span> <span class="d_keyword">const</span> KeyType s);
</span></pre>

        <p>For example:</p>

<pre class="d_code"><span class="notranslate"><span class="d_keyword">import</span> std.string;

<span class="d_keyword">struct</span> MyString {
  string str;

  <span class="d_keyword">const</span> hash_t <b><i>toHash</i></b>()
  { hash_t hash;
    <span class="d_keyword">foreach</span> (<span class="d_keyword">char</span> c; str)
      hash = (hash * 9) + c;
    <span class="d_keyword">return</span> hash;
  }

  <span class="d_keyword">const</span> <span class="d_keyword">bool</span> <b><i>opEquals</i></b>(<span class="d_keyword">ref</span> <span class="d_keyword">const</span> MyString s)
  {
    <span class="d_keyword">return</span> std.string.cmp(<span class="d_keyword">this</span>.str, s.str) == 0;
  }

}
</span></pre>

        <p>Care should be taken that <span class="notranslate"><span class="d_inlinecode donthyphenate">toHash</span></span> should consistently be the
        same value when <span class="notranslate"><span class="d_inlinecode donthyphenate">opEquals</span></span> returns true. In other words, two structs
        that are considered equal should always have the same hash value. If
        this is not the case, the associative array will not function properly.
        Also note that <span class="notranslate"><span class="d_inlinecode donthyphenate">opCmp</span></span> is not used to check for equality by the
        associative array.  For this reason, and for legacy reasons, an
        associative array key is not allowed to define a specialized <span class="notranslate"><span class="d_inlinecode donthyphenate">        opCmp</span></span>, but omit a specialized <span class="notranslate"><span class="d_inlinecode donthyphenate">opEquals</span></span>. This restriction may be
        removed in future versions of D.</p>

<h3>Construction or assignment on setting AA entries</h3>

    <p>When an AA indexing access appears on the left side of an assignment operator,
        it is specially handled for setting AA entry associated with the key.

<pre class="d_code"><span class="notranslate">string[<span class="d_keyword">int</span>] aa;
string s;
s = aa[1];          <span class="d_comment">// throws RangeError in runtime
</span>aa[1] = <span class="d_string">"hello"</span>;    <span class="d_comment">// handled for setting AA entry
</span>s = aa[1];          <span class="d_comment">// succeeds to lookup
</span><span class="d_keyword">assert</span>(s == <span class="d_string">"hello"</span>);
</span></pre>
    </p>

    <p>If the assigned value type is equivalent with the AA element type:

      <ol>        <li>If the indexing key does not yet exist in AA, a new AA entry will be
        allocated, and it will be initialized with the assigned value.</li>
        <li>If the indexing key already exists in the AA, the setting runs normal
        assignment.</li>
      </ol>

<pre class="d_code"><span class="notranslate"><span class="d_keyword">struct</span> S {
  <span class="d_keyword">int</span> val;
  <span class="d_keyword">void</span> opAssign(S rhs) { <span class="d_keyword">this</span>.val = rhs.val * 2; }
}
S[<span class="d_keyword">int</span>] aa;
aa[1] = S(10);  <span class="d_comment">// first setting initializes the entry aa[1]
</span><span class="d_keyword">assert</span>(aa[1].val == 10);
aa[1] = S(10);  <span class="d_comment">// second setting invokes normal assignment, and
</span>                <span class="d_comment">// operator-overloading rewrites it to member opAssign function.
</span><span class="d_keyword">assert</span>(aa[1].val == 20);
</span></pre>
    </p>

    <p>Even if the assigned value type is not equivalent with the AA element type,
        it could invoke operator overloading with normal indexing access.

<pre class="d_code"><span class="notranslate"><span class="d_keyword">struct</span> S {
  <span class="d_keyword">int</span> val;
  <span class="d_keyword">void</span> opAssign(<span class="d_keyword">int</span> v) { <span class="d_keyword">this</span>.val = v * 2; }
}
S[<span class="d_keyword">int</span>] aa;
aa[1] = 10;     <span class="d_comment">// is rewritten to: aa[1].opAssign(10), and
</span>                <span class="d_comment">// throws RangeError before opAssign is called
</span></span></pre>

        However, if the AA element type is struct and it supports implicit constructor
        call from the assigned value, the construction is used for the setting
        AA entry.

<pre class="d_code"><span class="notranslate"><span class="d_keyword">struct</span> S {
  <span class="d_keyword">int</span> val;
  <span class="d_keyword">this</span>(<span class="d_keyword">int</span> v) { <span class="d_keyword">this</span>.val = v; }
  <span class="d_keyword">void</span> opAssign(<span class="d_keyword">int</span> v) { <span class="d_keyword">this</span>.val = v * 2; }
}
S s = 1;    <span class="d_comment">// OK, rewritten to: S s = S(1);
</span>  s = 1;    <span class="d_comment">// OK, rewritten to: s.opAssign(1);
</span>
S[<span class="d_keyword">int</span>] aa;
aa[1] = 10; <span class="d_comment">// first setting is rewritten to: aa[1] = S(10);
</span><span class="d_keyword">assert</span>(aa[1].val == 10);
aa[1] = 10; <span class="d_comment">// second setting is rewritten to: aa[1].opAssign(10);
</span><span class="d_keyword">assert</span>(aa[1].val == 20);
</span></pre>

        This is designed for efficient memory reuse with some value-semantics
        structs, eg. <a href="phobos/std_bigint.html#BigInt"><span class="notranslate"><span class="d_inlinecode donthyphenate">std.bigint.BigInt</span></span></a>.

<pre class="d_code"><span class="notranslate"><span class="d_keyword">import</span> std.bigint;
BigInt[string] aa;
aa[<span class="d_string">"a"</span>] = 10;   <span class="d_comment">// construct BigInt(10) and move it in AA
</span>aa[<span class="d_string">"a"</span>] = 20;   <span class="d_comment">// call aa["a"].opAssign(20)
</span></span></pre>
    </p>

<h3>Runtime Initialization of Immutable AAs</h3>

    <p>Immutable associative arrays are often desirable, but sometimes
        initialization must be done at runtime. This can be achieved with
        a constructor (static constructor depending on scope),
        a buffer associative array and <span class="notranslate"><span class="d_inlinecode donthyphenate">assumeUnique</span></span>:</p>

<pre class="d_code"><span class="notranslate"><span class="d_keyword">immutable</span> <span class="d_keyword">long</span>[string] aa;

<span class="d_keyword">static</span> <span class="d_keyword">this</span>()
{
    <span class="d_keyword">import</span> std.exception : assumeUnique;
    <span class="d_keyword">import</span> std.conv : to;

    <span class="d_keyword">long</span>[string] temp; <span class="d_comment">// mutable buffer
</span>    <span class="d_keyword">foreach</span>(i; 0 .. 10)
    {
        temp[to!string(i)] = i;
    }
    temp.rehash; <span class="d_comment">// for faster lookups
</span>
    aa = assumeUnique(temp);
}

<span class="d_keyword">unittest</span>
{
    <span class="d_keyword">assert</span>(aa[<span class="d_string">"1"</span>] == 1);
    <span class="d_keyword">assert</span>(aa[<span class="d_string">"5"</span>] == 5);
    <span class="d_keyword">assert</span>(aa[<span class="d_string">"9"</span>] == 9);
}
</span></pre>


<h3>Properties</h3>

Properties for associative arrays are:

    <center><table border=1 cellpadding=4 cellspacing=0><caption>Associative Array Properties</caption>        <tr><th class="donthyphenate"><b>Property</b></th><th class="donthyphenate"><b>Description</b></th></tr>
        <tr><td><span class="notranslate"><span class="d_inlinecode donthyphenate">.sizeof</span></span></td><td>Returns the size of the reference to the associative
        array; it is 4 in 32-bit builds and 8 on 64-bit builds.</td></tr>
        <tr><td><span class="notranslate"><span class="d_inlinecode donthyphenate">.length</span></span></td><td>Returns number of values in the
        associative array. Unlike for dynamic arrays, it is read-only.</td></tr>
        <tr><td><span class="notranslate"><span class="d_inlinecode donthyphenate">.dup</span></span></td><td>Create a new associative array of the same size
        and copy the contents of the associative array into it.</td></tr>
        <tr><td><span class="notranslate"><span class="d_inlinecode donthyphenate">.keys</span></span></td><td>Returns dynamic array, the elements of which are the keys in
        the associative array.</td></tr>
        <tr><td><span class="notranslate"><span class="d_inlinecode donthyphenate">.values</span></span></td><td>Returns dynamic array, the elements of which are the values in
        the associative array.</td></tr>
        <tr><td><span class="notranslate"><span class="d_inlinecode donthyphenate">.rehash</span></span></td><td>Reorganizes the associative array in place so that lookups
        are more efficient. <span class="notranslate"><span class="d_inlinecode donthyphenate">rehash</span></span> is effective when, for example,
        the program is done loading up a symbol table and now needs
        fast lookups in it. Returns a reference to the reorganized array.</td></tr>
        <tr><td><span class="notranslate"><span class="d_inlinecode donthyphenate">.byKey()</span></span></td><td>Returns a delegate suitable for use as a <i>ForeachAggregate</i> to
        a <a href="statement.html#ForeachStatement"><i>ForeachStatement</i></a>  which will iterate over the keys
        of the associative array.</td></tr>
        <tr><td><span class="notranslate"><span class="d_inlinecode donthyphenate">.byValue()</span></span></td><td>Returns a delegate suitable for use as a <i>ForeachAggregate</i> to
        a <a href="statement.html#ForeachStatement"><i>ForeachStatement</i></a>  which will iterate over the values
        of the associative array.</td></tr>
        <tr><td><span class="notranslate"><span class="d_inlinecode donthyphenate">.get(Key key, lazy Value defVal)</span></span></td><td>        Looks up <span class="notranslate"><span class="d_inlinecode donthyphenate">key</span></span>; if it exists returns corresponding value
        else evaluates and returns <span class="notranslate"><span class="d_inlinecode donthyphenate">defVal</span></span>.</td></tr>
    </table></center>

<hr>
<h3>Associative Array Example: word count</h3>

        <p>Let's consider the file is ASCII encoded with LF EOL.
        In general case we should use <i>dchar c</i> for iteration
        over code points and functions from <a href="phobos/std_uni.html">std.uni</a>.
        </p>

<pre class="d_code"><span class="notranslate"><span class="d_keyword">import</span> std.file;         <span class="d_comment">// D file I/O
</span><span class="d_keyword">import</span> std.stdio;
<span class="d_keyword">import</span> std.ascii;

<span class="d_keyword">void</span> main (string[] args) {
  <span class="d_keyword">ulong</span> totalWords, totalLines, totalChars;
  <span class="d_keyword">ulong</span>[string] dictionary;

  writeln(<span class="d_string">"   lines   words   bytes file"</span>);
  <span class="d_keyword">foreach</span> (arg; args[1 .. $]) <span class="d_comment">// for each argument except the first one
</span>  {
    <span class="d_keyword">ulong</span> wordCount, lineCount, charCount;

    <span class="d_keyword">foreach</span>(line; File(arg).byLine())
    {
      <span class="d_keyword">bool</span> inWord;
      size_t wordStart;

      <span class="d_keyword">void</span> tryFinishWord(size_t wordEnd)
      {
        <span class="d_keyword">if</span> (inWord)
        {
          <span class="d_keyword">auto</span> word = line[wordStart .. wordEnd];
          ++dictionary[word.idup];   <span class="d_comment">// increment count for word
</span>          inWord = <span class="d_keyword">false</span>;
        }
      }

      <span class="d_keyword">foreach</span> (i, <span class="d_keyword">char</span> c; line)
      {
        <span class="d_keyword">if</span> (std.ascii.isDigit(c))
        { <span class="d_comment">// c is a digit (0..9)
</span>        }
        <span class="d_keyword">else</span> <span class="d_keyword">if</span> (std.ascii.isAlpha(c))
        { <span class="d_comment">// c is an ASCII letter (A..Z, a..z)
</span>          <span class="d_keyword">if</span> (!inWord)
          {
            wordStart = i;
            inWord = <span class="d_keyword">true</span>;
            ++wordCount;
          }
        }
        <span class="d_keyword">else</span>
          tryFinishWord(i);
        ++charCount;
      }
      tryFinishWord(line.length);
      ++lineCount;
    }

    writefln(<span class="d_string">"%8s%8s%8s %s"</span>, lineCount, wordCount, charCount, arg);
    totalWords += wordCount;
    totalLines += lineCount;
    totalChars += charCount;
  }

  <span class="d_keyword">if</span> (args.length &gt; 2)
  {
    writefln(<span class="d_string">"-------------------------------------\n%8s%8s%8s total"</span>,
            totalLines, totalWords, totalChars);
  }

  writeln(<span class="d_string">"-------------------------------------"</span>);
  <span class="d_keyword">foreach</span> (word; dictionary.keys.sort)
  {
    writefln(<span class="d_string">"%3s %s"</span>, dictionary[word], word);
  }
}
</span></pre>


  
<div id="google_ad">
<!-- Google ad -->
<script type="text/javascript"><!--
/**/google_ad_client = "pub-5628673096434613";
/**/google_ad_width = 728;
/**/google_ad_height = 90;
/**/google_ad_format = "728x90_as";
/**/google_ad_channel ="3651639259";
/**/google_page_url = document.location;
//--></script>
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
</div><!--/content-->



<div id="footernav">
<a href="http://forum.dlang.org/" title="User Forums">Forums</a> |
<a href="http://wiki.dlang.org/DocComments/AssociativeArrays" title="Read/write comments and feedback">Comments</a> |
<a href="http://digitalmars.com/advancedsearch.html" title="Search Digital Mars web site">Search</a> |
<a href="download.html" title="Download D">Downloads</a> |
<a href="/">Home</a>
</div>
<div id="copyright">

Copyright &copy; 1999-2017 by Digital Mars &reg;, All Rights Reserved |
Page generated by <a href="ddoc.html">Ddoc</a> on (no date time)
</div>
</body>
</html>
