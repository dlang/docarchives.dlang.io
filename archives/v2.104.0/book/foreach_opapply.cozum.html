
<!DOCTYPE html>
<html lang="en-US">
<!--
    Copyright (c) 1999-2024 by the D Language Foundation
    All Rights Reserved.
    https://dlang.org/foundation_overview.html
  -->
<head>
<meta charset="utf-8">
<meta name="keywords" content="D programming language">
<meta name="description" content="D Programming Language">
<title>foreach with Structs and Classes Solutions - D Programming Language</title>

<link rel="stylesheet" href="../css/codemirror.css">
<link rel="stylesheet" href="../css/style.css">
<link rel="stylesheet" href="../css/print.css" media="print">
<link rel="shortcut icon" href="../favicon.ico">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.1, maximum-scale=10.0">

</head>
<body id='foreach with Structs and Classes Solutions' class='doc'>
<script type="text/javascript">document.body.className += ' have-javascript'</script>
<div id="top"><div class="helper"><div class="helper expand-container">    <div class="logo"><a href="."><img id="logo" alt="D Logo" src="../images/dlogo.svg"></a></div>
    <a href="../menu.html" title="Menu" class="hamburger expand-toggle"><span>Menu</span></a>
    
<div id="cssmenu"><ul>    <li><a href='https://tour.dlang.org'><span>Learn</span></a></li>
    <li class='expand-container'><a class='expand-toggle' href='../documentation.html'><span>Documentation</span></a>
      
<ul class='expand-content'>    <li><a href='../spec/spec.html'>Language Reference</a></li>
    <li><a href='../phobos/index.html'>Library Reference</a></li>
    <li><a href='../dmd.html'>Command-line Reference</a></li>
    <li class="menu-divider"><a href='../comparison.html'>Feature Overview</a></li>
    <li><a href='../articles.html'>Articles</a></li>
 </ul></li>
    <li><a href='../download.html'><span>Downloads</span></a></li>
    <li><a href='https://code.dlang.org'><span>Packages</span></a></li>
    <li class='expand-container'><a class='expand-toggle' href='../community.html'><span>Community</span></a>
      
<ul class='expand-content'>    <li><a href='https://dlang.org/blog'>Blog</a></li>
    <li><a href='../orgs-using-d.html'>Orgs using D</a></li>
    <li><a href='https://twitter.com/search?q=%23dlang'>Twitter</a></li>
    <li><a href='../calendar.html'>Calendar</a></li>
    <li class="menu-divider"><a href='https://forum.dlang.org'>Forums</a></li>
    <li><a href='irc://irc.libera.chat/d'>IRC</a></li>
    <li><a href='https://discord.gg/bMZk9Q4'>Community Discord</a></li>
    <li><a href='https://wiki.dlang.org'>Wiki</a></li>
    <li class="menu-divider"><a href='https://github.com/dlang'>GitHub</a></li>
    <li><a href='../bugstats.html'>Issues</a></li>
    <li><a href='https://wiki.dlang.org/Get_involved'>Get involved</a></li>
    <li class="menu-divider"><a href='../foundation/contributors.html'>Contributors</a></li>
    <li><a href='../foundation/index.html'>Foundation</a></li>
    <li><a href='..//security.html'>Security Team</a></li>
    <li><a href='../foundation/donate.html'>Donate</a></li>
    <li><a href='../foundation/sponsors.html'>Sponsors</a></li>
 </ul></li>
    <li class='expand-container'><a class='expand-toggle' href='../resources.html'><span>Resources</span></a>
      
<ul class='expand-content'>    <li><a href='https://tour.dlang.org'>Tour</a></li>
    <li><a href='https://wiki.dlang.org/Books'>Books</a></li>
    <li><a href='https://wiki.dlang.org/Tutorials'>Tutorials</a></li>
    <li class="menu-divider"><a href='https://wiki.dlang.org/Development_tools'>Tools</a></li>
    <li><a href='https://wiki.dlang.org/Editors'>Editors</a></li>
    <li><a href='https://wiki.dlang.org/IDEs'>IDEs</a></li>
    <li><a href='https://run.dlang.io'>run.dlang.io</a></li>
    <li><a href='http://rainers.github.io/visuald/visuald/StartPage.html'>Visual D</a></li>
    <li class="menu-divider"><a href='../acknowledgements.html'>Acknowledgments</a></li>
    <li><a href='../dstyle.html'>D Style</a></li>
    <li><a href='../glossary.html'>Glossary</a></li>
    <li><a href='../sitemap.html'>Sitemap</a></li>
 </ul></li>
</ul></div>
    <div class="search-container expand-container">        <a href="../search.html" class="expand-toggle" title="Search"><span>Search</span></a>
        
    <div id="search-box">        <form method="get" action="https://google.com/search">
            <input type="hidden" id="domains" name="domains" value="dlang.org">
            <input type="hidden" id="sourceid" name="sourceid" value="google-search">
            <span id="search-query"><input id="q" name="q" placeholder="Search"></span><span id="search-dropdown"><span class="helper">                <select id="sitesearch" name="sitesearch" size="1">
                    <option value="dlang.org">Entire Site</option>
                    <option  value="dlang.org/spec">Language</option>
                    <option  value="dlang.org/phobos">Library</option>
                    <option  value="forum.dlang.org">Forums</option>
                    
                </select>
            </span></span><span id="search-submit"><button type="submit"><i class="fa fa-search"></i><span>go</span></button></span>
        </form>
    </div>
    </div>
</div></div></div>

<div class="container">    
    <div class="hyphenate" id="content">        
<div id="tools"><div >	<div class="tip smallprint">		<a href="https://issues.dlang.org/enter_bug.cgi?bug_file_loc=http%3A%2F%2Fdlang.org/&amp;component=dlang.org&amp;op_sys=All&amp;priority=P3&amp;product=D&amp;rep_platform=All&amp;short_desc=%5Bforeach with Structs and Classes Solutions%5D&amp;version=D2&amp;bug_severity=enhancement">Report a bug</a>
		<div >			If you spot a problem with this page, click here to create a Bugzilla issue.
		</div>
	</div>
	<div class="tip smallprint">		<a href="https://github.com/dlang/dlang.org/edit/master/d.en/foreach_opapply.cozum.d">Improve this page</a>
		<div >			Quickly fork, edit online, and submit a pull request for this page.
			Requires a signed-in GitHub account. This works well for small changes.
			If you'd like to make larger changes you may want to consider using
			a local clone.
		</div>
	</div>
</div></div>
        <h1>foreach with Structs and Classes Solutions</h1>
        
        

<h4><code class="d_inline">foreach</code> with Structs and Classes Dersi Problem Çözümleri</h4>

<ol>
<li>The step size must be stored alongside <code class="d_inline">begin</code> and <code class="d_inline">end</code>, and the element value must be increased by that step size:

<pre class="d_code"><span class="d_keyword">struct</span> NumberRange {
    <span class="d_keyword">int</span> begin;
    <span class="d_keyword">int</span> end;
    <span class="hilite"><span class="d_keyword">int</span> stepSize;</span>

    <span class="d_keyword">int</span> opApply(<span class="d_keyword">int</span> <span class="d_keyword">delegate</span>(<span class="d_keyword">ref</span> <span class="d_keyword">int</span>) dg) <span class="d_keyword">const</span> {
        <span class="d_keyword">int</span> result;

        <span class="d_keyword">for</span> (<span class="d_keyword">int</span> number = begin; number != end; <span class="hilite">number += stepSize</span>) {
            result = dg(number);

            <span class="d_keyword">if</span> (result) {
                <span class="d_keyword">break</span>;
            }
        }

        <span class="d_keyword">return</span> result;
    }
}

<span class="d_keyword">import</span> std.stdio;

<span class="d_keyword">void</span> main() {
    <span class="d_keyword">foreach</span> (element; NumberRange(0, 10, 2)) {
        write(element, ' ');
    }
}
</pre>

</li>

<li>
<pre class="d_code"><span class="d_keyword">import</span> std.stdio;
<span class="d_keyword">import</span> std.string;

<span class="d_keyword">class</span> Student {
    string name;
    <span class="d_keyword">int</span> id;

    <span class="d_keyword">this</span>(string name, <span class="d_keyword">int</span> id) {
        <span class="d_keyword">this</span>.name = name;
        <span class="d_keyword">this</span>.id = id;
    }

    <span class="d_keyword">override</span> string toString() {
        <span class="d_keyword">return</span> format(<span class="d_string">"%s(%s)"</span>, name, id);
    }
}

<span class="d_keyword">class</span> Teacher {
    string name;
    string subject;

    <span class="d_keyword">this</span>(string name, string subject) {
        <span class="d_keyword">this</span>.name = name;
        <span class="d_keyword">this</span>.subject = subject;
    }

    <span class="d_keyword">override</span> string toString() {
        <span class="d_keyword">return</span> format(<span class="d_string">"%s teacher %s"</span>, subject, name);
    }
}

<span class="d_keyword">class</span> School {
<span class="d_keyword">private</span>:

    Student[] students;
    Teacher[] teachers;

<span class="d_keyword">public</span>:

    <span class="d_keyword">this</span>(Student[] students, Teacher[] teachers) {
        <span class="d_keyword">this</span>.students = students;
        <span class="d_keyword">this</span>.teachers = teachers;
    }

    <span class="d_comment">/* This opApply override will be called when the foreach
     * variable is a Student. */</span>
    <span class="d_keyword">int</span> opApply(<span class="d_keyword">int</span> <span class="d_keyword">delegate</span>(<span class="d_keyword">ref</span> <span class="hilite">Student</span>) dg) {
        <span class="d_keyword">int</span> result;

        <span class="d_keyword">foreach</span> (student; students) {
            result = dg(student);

            <span class="d_keyword">if</span> (result) {
                <span class="d_keyword">break</span>;
            }
        }

        <span class="d_keyword">return</span> result;
    }

    <span class="d_comment">/* Similarly, this opApply will be called when the foreach
     * variable is a Teacher. */</span>
    <span class="d_keyword">int</span> opApply(<span class="d_keyword">int</span> <span class="d_keyword">delegate</span>(<span class="d_keyword">ref</span> <span class="hilite">Teacher</span>) dg) {
        <span class="d_keyword">int</span> result;

        <span class="d_keyword">foreach</span> (teacher; teachers) {
            result = dg(teacher);

            <span class="d_keyword">if</span> (result) {
                <span class="d_keyword">break</span>;
            }
        }

        <span class="d_keyword">return</span> result;
    }
}

<span class="d_keyword">void</span> printIndented(T)(T value) {
    writeln(<span class="d_string">"  "</span>, value);
}

<span class="d_keyword">void</span> main() {
    <span class="d_keyword">auto</span> school = <span class="d_keyword">new</span> School(
        [ <span class="d_keyword">new</span> Student(<span class="d_string">"Can"</span>, 1),
          <span class="d_keyword">new</span> Student(<span class="d_string">"Canan"</span>, 10),
          <span class="d_keyword">new</span> Student(<span class="d_string">"Cem"</span>, 42),
          <span class="d_keyword">new</span> Student(<span class="d_string">"Cemile"</span>, 100) ],

        [ <span class="d_keyword">new</span> Teacher(<span class="d_string">"Nazmiye"</span>, <span class="d_string">"Math"</span>),
          <span class="d_keyword">new</span> Teacher(<span class="d_string">"Makbule"</span>, <span class="d_string">"Literature"</span>) ]);

    writeln(<span class="d_string">"Student loop"</span>);
    <span class="d_keyword">foreach</span> (<span class="hilite">Student</span> student; school) {
        printIndented(student);
    }

    writeln(<span class="d_string">"Teacher loop"</span>);
    <span class="d_keyword">foreach</span> (<span class="hilite">Teacher</span> teacher; school) {
        printIndented(teacher);
    }
}
</pre>

<p>The output:
</p>

<pre class="shell">Student loop
  Can(1)
  Canan(10)
  Cem(42)
  Cemile(100)
Teacher loop
  Math teacher Nazmiye
  Literature teacher Makbule
</pre>

<p>As you can see, the implementations of both of the <code class="d_inline">opApply()</code> overrides are exactly the same, except the slice that they iterate on. To reduce code duplication, the common functionality can be moved to an implementation function template, which then gets called by the two <code class="d_inline">opApply()</code> overrides:
</p>

<pre class="d_code"><span class="d_keyword">class</span> School {
<span class="d_comment">// ...
</span>
    <span class="d_keyword">int</span> opApplyImpl<span class="hilite">(T)</span>(T[] slice, <span class="d_keyword">int</span> <span class="d_keyword">delegate</span>(<span class="d_keyword">ref</span> T) dg) {
        <span class="d_keyword">int</span> result;

        <span class="d_keyword">foreach</span> (element; slice) {
            result = dg(element);

            <span class="d_keyword">if</span> (result) {
                <span class="d_keyword">break</span>;
            }
        }

        <span class="d_keyword">return</span> result;
    }

    <span class="d_keyword">int</span> opApply(<span class="d_keyword">int</span> <span class="d_keyword">delegate</span>(<span class="d_keyword">ref</span> Student) dg) {
        <span class="d_keyword">return</span> opApplyImpl(students, dg);
    }

    <span class="d_keyword">int</span> opApply(<span class="d_keyword">int</span> <span class="d_keyword">delegate</span>(<span class="d_keyword">ref</span> Teacher) dg) {
        <span class="d_keyword">return</span> opApplyImpl(teachers, dg);
    }
}
</pre>

</li>

</ol>


        <div class="smallprint" id="copyright">Copyright &copy; 1999-2024 by the <a href="../foundation_overview.html">D Language Foundation</a> | Page generated by
<a href="../spec/ddoc.html">Ddoc</a> on Mon Jan 29 21:09:29 2024
</div>
    </div>
</div>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript">window.jQuery || document.write('\x3Cscript src="../js/jquery-1.7.2.min.js">\x3C/script>');</script>
    <script type="text/javascript" src="../js/dlang.js"></script>
    
    <script type="text/javascript" src="../js/codemirror-compressed.js"></script>
    <script type="text/javascript" src="../js/run.js"></script>


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
</body>
</html>
